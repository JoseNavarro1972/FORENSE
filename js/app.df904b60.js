(function(){"use strict";var e={3153:function(e,o,r){var a=r(3751),s=r(641);const i={id:"app"};function t(e,o,r,a,t,n){const c=(0,s.g2)("NavBar"),l=(0,s.g2)("router-view");return(0,s.uX)(),(0,s.CE)("div",i,[(0,s.bF)(c),(0,s.bF)(l)])}var n=r(33);const c={class:"navbar"},l={class:"navbar-menu"},u={key:0,class:"user-info"},d={class:"user-name"};function m(e,o,r,a,i,t){return(0,s.uX)(),(0,s.CE)("nav",c,[o[0]||(o[0]=(0,s.Lk)("div",{class:"navbar-brand"},[(0,s.Lk)("span",{class:"app-title"},"Sistema de Análisis Forense")],-1)),(0,s.Lk)("div",l,[i.isLoggedIn?((0,s.uX)(),(0,s.CE)("div",u,[(0,s.Lk)("span",d,(0,n.v_)(i.userName),1)])):(0,s.Q3)("",!0)])])}var _=r(4335),h={name:"NavBar",data(){return{isLoggedIn:!1,userName:""}},created(){this.checkLoginStatus()},methods:{checkLoginStatus(){const e=localStorage.getItem("user_data"),o=localStorage.getItem("session_token");if(e&&o)try{const r=JSON.parse(e);this.isLoggedIn=!0,this.userName=r.nombres_usuario||"Usuario",_.A.defaults.headers.common["X-Session-Token"]=o}catch(r){console.error("Error al procesar datos de usuario:",r),this.clearSession()}else this.isLoggedIn=!1,this.userName=""},clearSession(){localStorage.removeItem("session_token"),localStorage.removeItem("user_data"),delete _.A.defaults.headers.common["X-Session-Token"],this.isLoggedIn=!1,this.userName=""}}},p=r(6262);const f=(0,p.A)(h,[["render",m],["__scopeId","data-v-2036c2e0"]]);var v=f,g={name:"App",components:{NavBar:v}};const b=(0,p.A)(g,[["render",t]]);var k=b,E=(r(8111),r(3579),r(5220));const L={class:"login-container"};function I(e,o,r,i,t,c){return(0,s.uX)(),(0,s.CE)("div",L,[o[6]||(o[6]=(0,s.Lk)("h2",null,"Iniciar Sesión",-1)),(0,s.Lk)("form",{onSubmit:o[2]||(o[2]=(0,a.D$)(((...e)=>c.login&&c.login(...e)),["prevent"]))},[(0,s.Lk)("div",null,[o[3]||(o[3]=(0,s.Lk)("label",{for:"usuario"},"Usuario:",-1)),(0,s.bo)((0,s.Lk)("input",{type:"text",id:"usuario","onUpdate:modelValue":o[0]||(o[0]=e=>t.usuario=e),required:""},null,512),[[a.Jo,t.usuario]])]),(0,s.Lk)("div",null,[o[4]||(o[4]=(0,s.Lk)("label",{for:"clave"},"Contraseña:",-1)),(0,s.bo)((0,s.Lk)("input",{type:"password",id:"clave","onUpdate:modelValue":o[1]||(o[1]=e=>t.clave=e),required:""},null,512),[[a.Jo,t.clave]])]),o[5]||(o[5]=(0,s.Lk)("button",{type:"submit"},"Iniciar Sesión",-1))],32),t.mensaje?((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,n.C4)(["mensaje",{"mensaje-error":!t.success,"mensaje-exito":t.success}])},(0,n.v_)(t.mensaje),3)):(0,s.Q3)("",!0)])}r(4114);class A{constructor(){this.timeoutId=null,this.inactivityTimeout=9e5,this.setupActivityListeners()}setupActivityListeners(){const e=["mousedown","mousemove","keypress","scroll","touchstart"];e.forEach((e=>{document.removeEventListener(e,this.resetInactivityTimer)})),e.forEach((e=>{document.addEventListener(e,this.resetInactivityTimer.bind(this))})),this.resetInactivityTimer()}resetInactivityTimer(){this.timeoutId&&clearTimeout(this.timeoutId),localStorage.getItem("session_token")&&(this.timeoutId=setTimeout((()=>{this.clearSession(),sessionStorage.setItem("redirect_message","Su sesión ha caducado por inactividad. Por favor inicie sesión nuevamente."),window.location.href="/#/"}),this.inactivityTimeout))}clearSession(){localStorage.removeItem("session_token"),localStorage.removeItem("user_data"),delete _.A.defaults.headers.common["X-Session-Token"]}setupAxiosInterceptors(){_.A.interceptors.request.use((e=>{const o=localStorage.getItem("session_token");return o&&(e.headers["X-Session-Token"]=o),e}),(e=>Promise.reject(e))),_.A.interceptors.response.use((e=>e),(e=>(e.response&&401===e.response.status&&(this.clearSession(),sessionStorage.setItem("redirect_message","Su sesión ha expirado. Por favor inicie sesión nuevamente."),window.location.href="/#/"),Promise.reject(e))))}}var C=new A,S={name:"LoginView",data(){return{usuario:"",clave:"",mensaje:"",success:!1}},created(){const e=sessionStorage.getItem("redirect_message");e&&(this.mensaje=e,this.success=!1,sessionStorage.removeItem("redirect_message"))},methods:{async login(){try{const e={usuario:this.usuario,clave:this.clave};console.log("Enviando datos:",JSON.stringify(e));const o=await _.A.post("http://localhost:3002/api/login",e);if(console.log("Respuesta del servidor:",o.data),o.data&&o.data.id_usuario){this.success=!0,this.mensaje="✅ Login exitoso, redirigiendo...",localStorage.setItem("session_token",o.data.id_sesion),localStorage.setItem("user_data",JSON.stringify({id_usuario:o.data.id_usuario,id_perfil:o.data.id_perfil,nombres_usuario:o.data.nombres_usuario})),_.A.defaults.headers.common["X-Session-Token"]=o.data.id_sesion,C.resetInactivityTimer();const e=1===o.data.id_perfil?"/menu-administrador":"/menu-usuario";console.log("Redirigiendo a:",e),setTimeout((()=>{this.$router.push(e)}),1e3)}else this.success=!1,this.mensaje="❌ "+(o.data.mensaje||"Error de autenticación")}catch(e){this.success=!1,console.error("Error al conectar con el servidor:",e),e.response&&e.response.data?this.mensaje="❌ "+e.response.data.mensaje:this.mensaje="❌ Error al comunicarse con el servidor."}}}};const R=(0,p.A)(S,[["render",I],["__scopeId","data-v-05a85b3c"]]);var y=R;const U={class:"admin-menu"},O={class:"barra-superior"},j={class:"container"};function N(e,o,r,a,i,t){return(0,s.uX)(),(0,s.CE)("div",U,[(0,s.Lk)("div",O,[(0,s.Lk)("button",{class:"boton-volver",onClick:o[0]||(o[0]=(...e)=>t.volver&&t.volver(...e))},"Volver")]),o[6]||(o[6]=(0,s.Lk)("h1",null,"Panel de Administración",-1)),(0,s.Lk)("p",null,"Bienvenido, "+(0,n.v_)(i.usuario.username)+" (Admin)",1),(0,s.Lk)("div",j,[(0,s.Lk)("button",{onClick:o[1]||(o[1]=e=>t.irA("ingreso"))},"INGRESO REGISTRO"),(0,s.Lk)("button",{onClick:o[2]||(o[2]=e=>t.irA("modificar-registro"))},"MODIFICAR REGISTRO"),(0,s.Lk)("button",{onClick:o[3]||(o[3]=e=>t.irA("consulta"))},"CONSULTAR REGISTRO"),(0,s.Lk)("button",{onClick:o[4]||(o[4]=e=>t.irA("crear-usuario"))},"CREAR USUARIO"),(0,s.Lk)("button",{onClick:o[5]||(o[5]=e=>t.irA("eliminar-usuario"))},"ELIMINAR USUARIO")])])}var x={name:"AdminView",data(){return{usuario:JSON.parse(localStorage.getItem("usuario"))||{}}},methods:{irA(e){this.$router.push(`/${e}`)},volver(){this.$router.go(-1)}}};const T=(0,p.A)(x,[["render",N],["__scopeId","data-v-6853144b"]]);var D=T;const X={class:"user-menu"},F={class:"barra-superior"},P={class:"container"};function z(e,o,r,a,i,t){return(0,s.uX)(),(0,s.CE)("div",X,[(0,s.Lk)("div",F,[(0,s.Lk)("button",{class:"boton-volver",onClick:o[0]||(o[0]=(...e)=>t.volver&&t.volver(...e))},"Volver")]),o[4]||(o[4]=(0,s.Lk)("h1",null,"Panel de Usuario",-1)),(0,s.Lk)("p",null,"Bienvenido, "+(0,n.v_)(i.usuario.username)+" (Usuario)",1),(0,s.Lk)("div",P,[(0,s.Lk)("button",{onClick:o[1]||(o[1]=e=>t.irA("ingreso"))},"INGRESO REGISTRO"),(0,s.Lk)("button",{onClick:o[2]||(o[2]=e=>t.irA("modificar"))},"MODIFICAR REGISTRO"),(0,s.Lk)("button",{onClick:o[3]||(o[3]=e=>t.irA("consultar"))},"CONSULTAR REGISTRO")])])}var V={name:"UserView",data(){return{usuario:JSON.parse(localStorage.getItem("usuario"))||{}}},methods:{irA(e){const o={ingreso:"/ingreso-registro",modificar:"/modificar-registro",consultar:"/consulta"};this.$router.push(o[e]||"/")},volver(){this.$router.go(-1)}}};const w=(0,p.A)(V,[["render",z],["__scopeId","data-v-126188c2"]]);var $=w;const M={class:"botones-superior"},q={class:"crear-usuario-container"},B={class:"crear-usuario"},J={class:"input-group"},Q={class:"input-group"},G={class:"input-group"};function H(e,o,r,i,t,c){return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.Lk)("div",M,[(0,s.Lk)("button",{class:"boton-volver",onClick:o[0]||(o[0]=(...e)=>c.volver&&c.volver(...e))},"Volver")]),o[10]||(o[10]=(0,s.Lk)("h1",{class:"titulo-principal"},"Crear Usuario",-1)),(0,s.Lk)("div",q,[(0,s.Lk)("div",B,[(0,s.Lk)("form",{class:"form-container",onSubmit:o[4]||(o[4]=(0,a.D$)(((...e)=>c.crearUsuario&&c.crearUsuario(...e)),["prevent"]))},[(0,s.Lk)("div",J,[o[5]||(o[5]=(0,s.Lk)("label",{for:"usuario"},"Nombre de Usuario:",-1)),(0,s.bo)((0,s.Lk)("input",{type:"text",id:"usuario","onUpdate:modelValue":o[1]||(o[1]=e=>t.nuevoUsuario.usuario=e),required:""},null,512),[[a.Jo,t.nuevoUsuario.usuario]])]),(0,s.Lk)("div",Q,[o[6]||(o[6]=(0,s.Lk)("label",{for:"clave"},"Contraseña:",-1)),(0,s.bo)((0,s.Lk)("input",{type:"password",id:"clave","onUpdate:modelValue":o[2]||(o[2]=e=>t.nuevoUsuario.clave=e),required:""},null,512),[[a.Jo,t.nuevoUsuario.clave]])]),(0,s.Lk)("div",G,[o[8]||(o[8]=(0,s.Lk)("label",{for:"rol"},"Rol:",-1)),(0,s.bo)((0,s.Lk)("select",{id:"rol","onUpdate:modelValue":o[3]||(o[3]=e=>t.nuevoUsuario.rol=e)},o[7]||(o[7]=[(0,s.Lk)("option",{value:"admin"},"Admin",-1),(0,s.Lk)("option",{value:"usuario"},"Usuario",-1)]),512),[[a.u1,t.nuevoUsuario.rol]])]),o[9]||(o[9]=(0,s.Lk)("button",{type:"submit"},"Crear Usuario",-1))],32),t.mensaje?((0,s.uX)(),(0,s.CE)("p",{key:0,class:(0,n.C4)({"mensaje-exito":t.esExito,"mensaje-error":!t.esExito})},(0,n.v_)(t.mensaje),3)):(0,s.Q3)("",!0)])])])}var K={name:"CrearUsuarioView",data(){return{nuevoUsuario:{usuario:"",clave:"",rol:"usuario"},mensaje:"",esExito:!1}},methods:{async crearUsuario(){try{this.mensaje="",await _.A.post("usuarios",this.nuevoUsuario),this.mensaje="✅ Usuario creado con éxito.",this.esExito=!0,this.nuevoUsuario={usuario:"",clave:"",rol:"usuario"},setTimeout((()=>{this.mensaje=""}),3e3),alert("Usuario creado con éxito")}catch(e){this.mensaje=e.response?.data?.mensaje||"❌ Error al crear usuario.",this.esExito=!1}},volver(){this.$router.go(-1)}}};const Z=(0,p.A)(K,[["render",H],["__scopeId","data-v-66f3cb83"]]);var W=Z;const Y={class:"botones-superior"},ee={class:"eliminar-usuario-container"},oe={class:"eliminar-usuario"},re={class:"input-group"},ae={class:"input-group"},se=["disabled"];function ie(e,o,r,i,t,c){return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.Lk)("div",Y,[(0,s.Lk)("button",{class:"boton-volver",onClick:o[0]||(o[0]=(...e)=>c.volver&&c.volver(...e))},"Volver")]),o[7]||(o[7]=(0,s.Lk)("h1",{class:"titulo-principal"},"Eliminar Usuario",-1)),(0,s.Lk)("div",ee,[(0,s.Lk)("div",oe,[(0,s.Lk)("form",{class:"form-container",onSubmit:o[4]||(o[4]=(0,a.D$)(((...e)=>c.confirmarEliminar&&c.confirmarEliminar(...e)),["prevent"]))},[(0,s.Lk)("div",re,[o[5]||(o[5]=(0,s.Lk)("label",{for:"nombre"},"Nombre de Usuario:",-1)),(0,s.bo)((0,s.Lk)("input",{type:"text",id:"nombre","onUpdate:modelValue":o[1]||(o[1]=e=>t.nombreUsuario=e),required:""},null,512),[[a.Jo,t.nombreUsuario]])]),(0,s.Lk)("button",{type:"button",onClick:o[2]||(o[2]=(...e)=>c.buscarUsuario&&c.buscarUsuario(...e))},"Buscar"),(0,s.Lk)("div",ae,[o[6]||(o[6]=(0,s.Lk)("label",{for:"id"},"ID del Usuario:",-1)),(0,s.bo)((0,s.Lk)("input",{type:"text",id:"id","onUpdate:modelValue":o[3]||(o[3]=e=>t.usuarioId=e),readonly:""},null,512),[[a.Jo,t.usuarioId]])]),(0,s.Lk)("button",{type:"submit",disabled:!t.usuarioId},"Eliminar Usuario",8,se)],32),t.mensaje?((0,s.uX)(),(0,s.CE)("p",{key:0,class:(0,n.C4)({"mensaje-exito":t.esExito,"mensaje-error":!t.esExito})},(0,n.v_)(t.mensaje),3)):(0,s.Q3)("",!0)])])])}r(116);var te={name:"EliminarUsuarioView",data(){return{nombreUsuario:"",usuarioId:"",mensaje:"",esExito:!1}},created(){const e=localStorage.getItem("session_token");e&&(_.A.defaults.headers.common["X-Session-Token"]=e)},methods:{async buscarUsuario(){if(!this.nombreUsuario.trim())return this.mensaje="❌ Debes ingresar un nombre de usuario.",this.esExito=!1,void this.limpiarMensaje(5e3);try{const e=await _.A.get(`http://localhost:3002/api/usuarios?buscar=${this.nombreUsuario}`);if(e.data&&e.data.length>0){const o=e.data.find((e=>e.nombres_usuario===this.nombreUsuario));o?(this.usuarioId=o.id_usuario,this.mensaje="✅ Usuario encontrado.",this.esExito=!0):(this.usuarioId="",this.mensaje="❌ Usuario no encontrado.",this.esExito=!1)}else this.usuarioId="",this.mensaje="❌ Usuario no encontrado.",this.esExito=!1;this.limpiarMensaje(5e3)}catch(e){console.error("❌ Error al buscar usuario:",e),this.mensaje="❌ Error al comunicarse con el servidor.",this.esExito=!1,this.limpiarMensaje(5e3)}},confirmarEliminar(){if(!this.usuarioId)return this.mensaje="❌ No hay un usuario seleccionado.",this.esExito=!1,void this.limpiarMensaje(5e3);confirm(`¿Está seguro que desea eliminar el usuario ${this.nombreUsuario}?`)&&this.eliminarUsuario()},async eliminarUsuario(){try{const e=await _.A.delete(`http://localhost:3002/api/usuarios/${this.usuarioId}`);e.data&&e.data.mensaje?(this.mensaje="✅ Usuario eliminado con éxito.",this.esExito=!0,this.nombreUsuario="",this.usuarioId=""):(this.mensaje="❌ Error al eliminar el usuario",this.esExito=!1,this.limpiarMensaje(5e3))}catch(e){console.error("❌ Error al eliminar usuario:",e),this.mensaje="❌ Error al comunicarse con el servidor.",this.esExito=!1,this.limpiarMensaje(5e3)}},volver(){this.$router.go(-1)},limpiarMensaje(e=5e3){setTimeout((()=>{this.mensaje=""}),e)}}};const ne=(0,p.A)(te,[["render",ie],["__scopeId","data-v-8dff08cc"]]);var ce=ne;const le={class:"botones-superior"},ue={class:"crear-usuario-container"},de={key:0,class:"mensaje-id"},me={class:"form-grid"},_e={class:"input-group"},he=["value"],pe=["for"],fe=["id","onUpdate:modelValue"],ve=["value"],ge=["type","id","onUpdate:modelValue"],be={class:"input-group observaciones-group"},ke=["disabled"],Ee={key:0,class:"spinner"};function Le(e,o,r,i,t,c){return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.Lk)("div",le,[(0,s.Lk)("button",{onClick:o[0]||(o[0]=(...e)=>c.volver&&c.volver(...e)),class:"boton-volver"},"Volver")]),o[7]||(o[7]=(0,s.Lk)("h1",{class:"titulo-principal"},"REGISTRO ANÁLISIS FORENSE",-1)),(0,s.Lk)("div",ue,[t.idLocal?((0,s.uX)(),(0,s.CE)("div",de,[(0,s.Lk)("p",null,[o[3]||(o[3]=(0,s.Lk)("strong",null,"Nro. Registro:",-1)),(0,s.eW)(" "+(0,n.v_)(t.idLocal),1)])])):(0,s.Q3)("",!0),(0,s.Lk)("form",{onSubmit:o[2]||(o[2]=(0,a.D$)(((...e)=>c.registrarIngreso&&c.registrarIngreso(...e)),["prevent"])),class:"crear-usuario"},[(0,s.Lk)("div",me,[(0,s.Lk)("div",_e,[o[4]||(o[4]=(0,s.Lk)("label",{for:"nro_registro"},"NRO. REGISTRO",-1)),(0,s.Lk)("input",{type:"text",id:"nro_registro",value:t.idLocal||"Pendiente...",readonly:""},null,8,he)]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t.ordenCampos,(e=>((0,s.uX)(),(0,s.CE)("div",{class:"input-group",key:e},[(0,s.Lk)("label",{for:e},(0,n.v_)(t.formLabels[e]||e),9,pe),"select"===c.getInputType(e)?(0,s.bo)(((0,s.uX)(),(0,s.CE)("select",{key:0,id:e,"onUpdate:modelValue":o=>t.form[e]=o},[o[5]||(o[5]=(0,s.Lk)("option",{value:""},"Seleccione...",-1)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t.selectFields[e],(e=>((0,s.uX)(),(0,s.CE)("option",{key:e,value:e},(0,n.v_)(e),9,ve)))),128))],8,fe)),[[a.u1,t.form[e]]]):(0,s.bo)(((0,s.uX)(),(0,s.CE)("input",(0,s.v6)({key:1,type:c.getInputAttributes(e).type,id:e,"onUpdate:modelValue":o=>t.form[e]=o,ref_for:!0},c.getInputAttributes(e)),null,16,ge)),[[a.hp,t.form[e]]])])))),128)),(0,s.Lk)("div",be,[o[6]||(o[6]=(0,s.Lk)("label",{for:"observaciones"},"OBSERVACIONES",-1)),(0,s.bo)((0,s.Lk)("textarea",{id:"observaciones","onUpdate:modelValue":o[1]||(o[1]=e=>t.form.observaciones=e)},null,512),[[a.Jo,t.form.observaciones]])])]),(0,s.Lk)("button",{type:"submit",disabled:t.loading},[t.loading?((0,s.uX)(),(0,s.CE)("span",Ee)):(0,s.Q3)("",!0),(0,s.eW)(" "+(0,n.v_)(t.loading?"Procesando...":t.idLocal?"Actualizar":"Registrar"),1)],8,ke)],32),t.message?((0,s.uX)(),(0,s.CE)("p",{key:1,class:(0,n.C4)({"mensaje-exito":t.success,"mensaje-error":!t.success})},(0,n.v_)(t.message),3)):(0,s.Q3)("",!0)])])}r(7588);var Ie={props:["id_ingreso"],data(){return{idLocal:null,form:{orden_judicial:"",fecha_recepcion:"",nombre_perito:"",grado_perito:"",oficio_remisor:"",fecha_oficio:"",ruc:"",fecha_instruccion_particular:"",fiscalia:"",tribunal_garantia:"",fecha_autorizacion_orden_judicial:"",nombre_juez_autoriza:"",nue:"",seccion:"",nro_parte:"",fecha_parte:"",delito:"",marca:"",modelo:"",nombre_imputado:"",cedula_identidad:"",nro_telefono:"",tipo_extraccion:"",nro_informe_extraccion:"",fecha_informe_extraccion:"",nro_informe_analisis:"",fecha_informe_analisis:"",tipo_solicitud:"",region:"",dia_plazo:null,prorroga:"",cant_celular:null,cant_extracciones:null,estado_evidencia:"",resultado:"",observaciones:""},message:"",success:!1,loading:!1,formLabels:{orden_judicial:"ORDEN JUDICIAL",fecha_recepcion:"FECHA RECEPCIÓN",nombre_perito:"NOMBRE PERITO",grado_perito:"GRADO PERITO",oficio_remisor:"OFICIO REMISOR",fecha_oficio:"FECHA OFICIO",ruc:"R.U.C.",fecha_instruccion_particular:"FECHA INSTRUCCIÓN PARTICULAR",fiscalia:"FISCALÍA",tribunal_garantia:"TRIBUNAL DE GARANTÍA",fecha_autorizacion_orden_judicial:"FECHA AUTORIZACIÓN ORDEN JUDICIAL",nombre_juez_autoriza:"NOMBRE JUEZ AUTORIZA",nue:"N.U.E.",seccion:"SECCIÓN",nro_parte:"N° PARTE",fecha_parte:"FECHA PARTE",delito:"DELITO",marca:"MARCA",modelo:"MODELO",nombre_imputado:"NOMBRE IMPUTADO",cedula_identidad:"CÉDULA IDENTIDAD",nro_telefono:"N° TELÉFONO",tipo_extraccion:"TIPO EXTRACCIÓN",nro_informe_extraccion:"N° INFORME RESUMEN EXTRACCIÓN",fecha_informe_extraccion:"FECHA INFORME RESUMEN EXTRACCIÓN",nro_informe_analisis:"N° INFORME ANÁLISIS",fecha_informe_analisis:"FECHA INFORME ANÁLISIS",tipo_solicitud:"TIPO SOLICITUD",region:"REGIÓN",dia_plazo:"DÍA PLAZO",prorroga:"PRÓRROGA",cant_celular:"CANT. CELULAR",cant_extracciones:"CANT. EXTRACCIONES",estado_evidencia:"ESTADO DE LA EVIDENCIA",resultado:"RESULTADO"},ordenCampos:["orden_judicial","fecha_recepcion","nombre_perito","grado_perito","oficio_remisor","fecha_oficio","ruc","fecha_instruccion_particular","fiscalia","tribunal_garantia","fecha_autorizacion_orden_judicial","nombre_juez_autoriza","nue","seccion","nro_parte","fecha_parte","delito","marca","modelo","nombre_imputado","cedula_identidad","nro_telefono","tipo_extraccion","nro_informe_extraccion","fecha_informe_extraccion","nro_informe_analisis","fecha_informe_analisis","tipo_solicitud","region","dia_plazo","prorroga","cant_celular","cant_extracciones","estado_evidencia","resultado"],selectFields:{estado_evidencia:["Recibida","En Proceso","Finalizada","Entregada"],tipo_solicitud:["Extraccion","Analisis","Extraccion/Analisis"],resultado:["Positivo","Negativo","Pendiente"],region:["Metropolitana","Valparaiso"]}}},computed:{todayDate(){const e=new Date;return e.toISOString().split("T")[0]}},async mounted(){this.$route.params.id_ingreso&&(this.idLocal=this.$route.params.id_ingreso,await this.cargarDatosIngreso())},methods:{async cargarDatosIngreso(){try{const e=localStorage.getItem("session_token"),o=await _.A.get(`http://localhost:3002/api/ingresos/${this.idLocal}`,{headers:{"X-Session-Token":e||""}});if(o.data){console.log("Datos recibidos del servidor:",o.data);const e={id_ingreso:"id_ingreso",nue:"nue",ruc:"ruc",orden_judicial:"orden_judicial",fecha_recepcion:"fecha_recepcion",fecha_oficio:"fecha_oficio",fecha_instruccion_particular:"fecha_instruccion_particular",fecha_autorizacion_orden_judicial:"fecha_autorizacion_orden_judicial",fecha_parte:"fecha_parte",fecha_informe_extraccion:"fecha_informe_extraccion",fecha_informe_analisis:"fecha_informe_analisis",prorroga:"prorroga",nombre_perito:"nombre_perito",grado_perito:"grado_perito",nombre_juez_autoriza:"nombre_juez_autoriza",oficio_remisor:"oficio_remisor",nro_parte:"nro_parte",fiscalia:"fiscalia",tribunal_garantia:"tribunal_garantia",seccion:"seccion",delito:"delito",marca:"marca",modelo:"modelo",nombre_imputado:"nombre_imputado",cedula_identidad:"cedula_identidad",nro_telefono:"numero_telefono_ingreso",tipo_extraccion:"tipo_extraccion",nro_informe_extraccion:"nro_informe_extraccion",nro_informe_analisis:"nro_informe_analisis",tipo_solicitud:"tipo_solicitud",region:"region",dia_plazo:"dia_plazo",cant_celular:"cant_celular",cant_extracciones:"cant_extracciones",estado_evidencia:"estado_evidencia",resultado:"resultado",observaciones:"observaciones"};Object.keys(e).forEach((r=>{const a=e[r];if(void 0!==o.data[a])if(console.log(`✅ Asignando ${a} → ${r}: ${o.data[a]}`),"string"===typeof o.data[a]&&o.data[a].includes("T")){const e=new Date(o.data[a]);this.form[r]=e.toISOString().split("T")[0]}else this.form[r]=o.data[a]})),this.form.id_ingreso=o.data.id_ingreso,console.log("✓ Campos cargados en el formulario:",this.form)}}catch(e){console.error("Error al cargar datos:",e),this.message="Error al cargar los datos del registro.",this.success=!1,e.response&&404===e.response.status&&(this.message="El registro solicitado no existe.")}},getInputType(e){if(Object.keys(this.selectFields).includes(e))return"select";const o=["fecha_parte","fecha_recepcion","fecha_oficio","fecha_informe_extraccion","fecha_informe_analisis","fecha_instruccion_particular","fecha_autorizacion_orden_judicial","prorroga"],r=["cant_celular","cant_extracciones","dia_plazo"];return o.includes(e)?"date":r.includes(e)?"number":"text"},getInputAttributes(e){const o=["fecha_parte","fecha_recepcion","fecha_oficio","fecha_informe_extraccion","fecha_informe_analisis","fecha_instruccion_particular","fecha_autorizacion_orden_judicial","prorroga"],r=["cant_celular","cant_extracciones","dia_plazo"];return o.includes(e)?{type:"date",max:this.todayDate}:r.includes(e)?{type:"number"}:{type:"text"}},resetForm(){this.form=JSON.parse(JSON.stringify(this.$options.data().form)),this.idLocal=null},async registrarIngreso(){this.loading=!0,this.message="";try{console.log("Valores en formulario antes de enviar:"),console.log("NUE:",this.form.nue),console.log("RUC:",this.form.ruc);const e={id_ingreso:this.idLocal,nue_ingreso:this.form.nue||"",causa_ruc_ingreso:this.form.ruc||"",estado_pericia:this.form.estado_evidencia||"Recibida",estado_evidencia:this.form.estado_evidencia||"Recibida",fecha_recepcion_ingreso:this.form.fecha_recepcion||null,fecha_oficio:this.form.fecha_oficio||null,fecha_ip_ingreso:this.form.fecha_instruccion_particular||null,fecha_orden_judicial_ingreso:this.form.fecha_autorizacion_orden_judicial||null,fecha_parte:this.form.fecha_parte||null,fecha_informe_extraccion:this.form.fecha_informe_extraccion||null,fecha_informe_analisis:this.form.fecha_informe_analisis||null,prorroga:this.form.prorroga||null,nombre_perito_ingreso:this.form.nombre_perito||"",grado_perito_ingreso:this.form.grado_perito||"",nombre_juez_ingreso:this.form.nombre_juez_autoriza||"",oficio_remisor:this.form.oficio_remisor||"",nro_parte:this.form.nro_parte||"",fiscalia_ingreso:this.form.fiscalia||"",tribunal_garantia_ingreso:this.form.tribunal_garantia||"",orden_judicial:this.form.orden_judicial||"",marca_ingreso:this.form.marca||"",modelo_ingreso:this.form.modelo||"",numero_telefono_ingreso:this.form.nro_telefono||"",tipo_extraccion:this.form.tipo_extraccion||"",nro_informe_extraccion:this.form.nro_informe_extraccion||"",nro_informe_analisis:this.form.nro_informe_analisis||"",tipo_solicitud:this.form.tipo_solicitud||"",plazo_pericia_ingreso:this.form.dia_plazo||null,cant_celular:this.form.cant_celular||null,cant_extracciones:this.form.cant_extracciones||null,resultado:this.form.resultado||"",observaciones:this.form.observaciones||"",id_usuario:1};if(console.log("Enviando datos al servidor:",e),!e.nue_ingreso||!e.causa_ruc_ingreso)return console.error("❌ Campos críticos faltantes:",{nue_ingreso:e.nue_ingreso,causa_ruc_ingreso:e.causa_ruc_ingreso}),this.message="Error: Falta NUE o RUC. Por favor, complete estos campos.",this.success=!1,void(this.loading=!1);const o=localStorage.getItem("session_token"),r=await _.A.post("http://localhost:3002/api/ingresos",e,{headers:{"Content-Type":"application/json","X-Session-Token":o||""}});r.data.success?(this.success=!0,this.message=this.idLocal?"Registro actualizado con éxito.":"Registro creado con éxito.",!this.idLocal&&r.data.id_ingreso&&(this.idLocal=r.data.id_ingreso),this.idLocal||setTimeout((()=>{this.resetForm(),this.message=""}),3e3)):(this.success=!1,this.message=r.data.message||"Error al procesar el registro.")}catch(e){this.success=!1,console.error("Error en la operación:",e),e.response?(console.error("Respuesta de error:",e.response.data),this.message=`Error: ${e.response.data.message||"Error de comunicación con el servidor."}`):this.message="Error de comunicación con el servidor."}finally{this.loading=!1}},volver(){this.$router.go(-1)}}};const Ae=(0,p.A)(Ie,[["render",Le],["__scopeId","data-v-cc151dda"]]);var Ce=Ae;const Se={class:"consulta-registro-container"},Re={class:"botones-superior"},ye={class:"bloque-busqueda"},Ue={class:"columna-izquierda"},Oe=["for"],je={class:"columna-derecha"},Ne=["type","placeholder","onUpdate:modelValue"],xe=["onClick"],Te={class:"fila-botones"},De={key:0,class:"loading-container"},Xe={key:1,class:"resultados-container"},Fe={class:"tabla-resultados"},Pe=["href"],ze={key:2};function Ve(e,o,r,i,t,c){return(0,s.uX)(),(0,s.CE)("div",Se,[(0,s.Lk)("div",Re,[(0,s.Lk)("button",{onClick:o[0]||(o[0]=(...e)=>c.volver&&c.volver(...e)),class:"boton-volver"},"Volver")]),o[9]||(o[9]=(0,s.Lk)("h1",{class:"title"},"CONSULTA DE REGISTROS FORENSES",-1)),(0,s.Lk)("form",{onSubmit:o[4]||(o[4]=(0,a.D$)(((...e)=>c.consultaRegistros&&c.consultaRegistros(...e)),["prevent"])),class:"consulta-form"},[(0,s.Lk)("div",ye,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t.campos,((e,r)=>((0,s.uX)(),(0,s.CE)("div",{class:"fila-busqueda",key:r},[(0,s.Lk)("div",Ue,[(0,s.Lk)("label",{for:r},(0,n.v_)(e),9,Oe)]),(0,s.Lk)("div",je,["fecha_desde_hasta"===r?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[(0,s.bo)((0,s.Lk)("input",{type:"date","onUpdate:modelValue":o[1]||(o[1]=e=>t.criterios.fecha_desde=e)},null,512),[[a.Jo,t.criterios.fecha_desde]]),o[5]||(o[5]=(0,s.Lk)("span",{style:{margin:"0 5px"}},"hasta",-1)),(0,s.bo)((0,s.Lk)("input",{type:"date","onUpdate:modelValue":o[2]||(o[2]=e=>t.criterios.fecha_hasta=e)},null,512),[[a.Jo,t.criterios.fecha_hasta]])],64)):((0,s.uX)(),(0,s.CE)(s.FK,{key:1},[(0,s.bo)((0,s.Lk)("input",{type:"anio"===r?"number":"text",placeholder:e,"onUpdate:modelValue":e=>t.criterios[r]=e},null,8,Ne),[[a.hp,t.criterios[r]]]),(0,s.Lk)("button",{type:"button",onClick:e=>c.buscarPor(r)},"Buscar",8,xe)],64))])])))),128)),(0,s.Lk)("div",Te,[(0,s.Lk)("button",{type:"button",onClick:o[3]||(o[3]=(...e)=>c.mostrarTodos&&c.mostrarTodos(...e)),class:"boton-mostrar-todos"}," Mostrar Todos los Registros ")])])],32),t.loading?((0,s.uX)(),(0,s.CE)("div",De,o[6]||(o[6]=[(0,s.Lk)("div",{class:"loading-spinner"},null,-1),(0,s.Lk)("p",null,"Cargando resultados...",-1)]))):t.resultados.length>0?((0,s.uX)(),(0,s.CE)("div",Xe,[o[8]||(o[8]=(0,s.Lk)("h2",{class:"subtitle"},"Resultados Encontrados:",-1)),(0,s.Lk)("table",Fe,[o[7]||(o[7]=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"NRO. ORDEN"),(0,s.Lk)("th",null,"ID FORENSE"),(0,s.Lk)("th",null,"ESTADO DE LA EVIDENCIA"),(0,s.Lk)("th",null,"FECHA RECEPCION"),(0,s.Lk)("th",null,"CAUSA RUC"),(0,s.Lk)("th",null,"FISCALIA"),(0,s.Lk)("th",null,"FECHA I.P."),(0,s.Lk)("th",null,"TRIBUNAL DE GARANTIA"),(0,s.Lk)("th",null,"N.U.E")])],-1)),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t.resultados,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id_forense},[(0,s.Lk)("td",null,(0,n.v_)(e.nro_orden),1),(0,s.Lk)("td",null,[(0,s.Lk)("a",{href:`/ingreso_formulario?id=${e.id_forense}`},(0,n.v_)(e.id_forense),9,Pe)]),(0,s.Lk)("td",null,(0,n.v_)(e.estado_evidencia),1),(0,s.Lk)("td",null,(0,n.v_)(e.fecha_recepcion),1),(0,s.Lk)("td",null,(0,n.v_)(e.causa_ruc),1),(0,s.Lk)("td",null,(0,n.v_)(e.fiscalia),1),(0,s.Lk)("td",null,(0,n.v_)(e.fecha_ip),1),(0,s.Lk)("td",null,(0,n.v_)(e.tribunal_garantia),1),(0,s.Lk)("td",null,(0,n.v_)(e.nue),1)])))),128))])])])):t.busquedaRealizada&&!t.loading?((0,s.uX)(),(0,s.CE)("p",ze," No se encontraron registros con los criterios especificados. ")):(0,s.Q3)("",!0),t.message?((0,s.uX)(),(0,s.CE)("p",{key:3,class:(0,n.C4)({"mensaje-error":!t.success})},(0,n.v_)(t.message),3)):(0,s.Q3)("",!0)])}r(2489),r(8237);var we={data(){return{criterios:{fecha_desde:"",fecha_hasta:"",anio:"",estado_evidencia:"",nue:"",ruc:"",marca:"",seccion:"",fiscalia:""},campos:{fecha_desde_hasta:"BÚSQUEDA POR FECHA INGRESO",anio:"BÚSQUEDA POR AÑO",estado_evidencia:"BÚSQUEDA POR ESTADO DE LA EVIDENCIA",nue:"BÚSQUEDA POR N.U.E",ruc:"BÚSQUEDA POR R.U.C",marca:"BÚSQUEDA POR MARCA",seccion:"BÚSQUEDA POR SECCIÓN",fiscalia:"BÚSQUEDA POR FISCALÍA"},resultados:[],loading:!1,message:"",success:!0,busquedaRealizada:!1}},methods:{async consultaRegistros(){this.loading=!0,this.message="",this.resultados=[],this.busquedaRealizada=!0;try{const e=Object.entries(this.criterios).filter((([,e])=>""!==e)).reduce(((e,[o,r])=>({...e,[o]:r})),{}),o=localStorage.getItem("session_token"),r="http://localhost:3002/api/consulta";console.log("📊 Consultando API con parámetros:",e);const a=await _.A.get(r,{params:e,headers:{"X-Session-Token":o||"","Content-Type":"application/json"}});console.log("📊 Respuesta recibida:",a.data),Array.isArray(a.data)?(this.resultados=a.data,this.success=!0,0===this.resultados.length&&(this.message="No se encontraron registros con los criterios especificados.")):(this.message="Formato de respuesta inesperado del servidor.",this.success=!1,console.error("Formato de respuesta inesperado:",a.data))}catch(e){console.error("❌ Error en consulta:",e),this.message="Error de comunicación con el servidor.",e.response?(console.error("❌ Datos del error:",e.response.data),console.error("❌ Estado:",e.response.status),e.response.data&&e.response.data.mensaje&&(this.message+=`: ${e.response.data.mensaje}`)):e.request?(console.error("❌ No se recibió respuesta. Posible error de conexión."),this.message+=": No se pudo conectar con el servidor."):(console.error("❌ Error al configurar la petición:",e.message),this.message+=`: ${e.message}`),this.success=!1}finally{this.loading=!1}},buscarPor(e){Object.keys(this.criterios).forEach((o=>{o!==e&&"fecha_desde"!==o&&"fecha_hasta"!==o&&(this.criterios[o]="")})),this.consultaRegistros()},mostrarTodos(){this.criterios={fecha_desde:"",fecha_hasta:"",anio:"",estado_evidencia:"",nue:"",ruc:"",marca:"",seccion:"",fiscalia:""},this.consultaRegistros()},volver(){this.$router.go(-1)}}};const $e=(0,p.A)(we,[["render",Ve],["__scopeId","data-v-2f0a25c4"]]);var Me=$e;const qe={class:"modificar-container"},Be={key:0},Je=["onClick"];function Qe(e,o,r,i,t,c){return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.Lk)("button",{class:"boton-volver",onClick:o[0]||(o[0]=(...e)=>c.volver&&c.volver(...e))},"Volver"),o[5]||(o[5]=(0,s.Lk)("h1",{class:"titulo-modificar"},"Actualizar Registro para Modificar",-1)),(0,s.Lk)("div",qe,[(0,s.Lk)("form",{onSubmit:o[2]||(o[2]=(0,a.D$)(((...e)=>c.buscar&&c.buscar(...e)),["prevent"]))},[(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":o[1]||(o[1]=e=>t.criterio=e),placeholder:"Ingrese ID o RUC",required:""},null,512),[[a.Jo,t.criterio]]),o[3]||(o[3]=(0,s.Lk)("button",{type:"submit"},"Buscar",-1))],32),t.resultados.length?((0,s.uX)(),(0,s.CE)("table",Be,[o[4]||(o[4]=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"ID Ingreso"),(0,s.Lk)("th",null,"RUC"),(0,s.Lk)("th",null,"Estado")])],-1)),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t.resultados,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id_ingreso},[(0,s.Lk)("td",{onClick:o=>c.editarRegistro(e.id_ingreso),style:{cursor:"pointer",color:"blue"}},(0,n.v_)(e.id_ingreso),9,Je),(0,s.Lk)("td",null,(0,n.v_)(e.causa_ruc_ingreso),1),(0,s.Lk)("td",null,(0,n.v_)(e.estado),1)])))),128))])])):(0,s.Q3)("",!0)])])}var Ge={data(){return{criterio:"",resultados:[]}},methods:{async buscar(){try{const e=localStorage.getItem("session_token"),o=await _.A.post("http://localhost:3002/api/buscar-modificar",{criterio:this.criterio},{headers:{"Content-Type":"application/json","X-Session-Token":e||""}});this.resultados=o.data.resultados}catch(e){console.error("Error al buscar:",e),alert("Error al comunicarse con el servidor. Verifique que el servidor esté activo.")}},editarRegistro(e){this.$router.push({name:"EditarIngreso",params:{id_ingreso:e}})},volver(){this.$router.go(-1)}}};const He=(0,p.A)(Ge,[["render",Qe],["__scopeId","data-v-73c43633"]]);var Ke=He;const Ze=[{path:"/",component:y,meta:{requiresAuth:!1}},{path:"/menu-administrador",component:D,meta:{requiresAuth:!0}},{path:"/menu-usuario",component:$,meta:{requiresAuth:!0}},{path:"/crear-usuario",component:W,meta:{requiresAuth:!0}},{path:"/eliminar-usuario",component:ce,meta:{requiresAuth:!0}},{path:"/ingreso-registro",component:Ce,alias:"/ingreso",meta:{requiresAuth:!0}},{path:"/consulta",component:Me,meta:{requiresAuth:!0}},{path:"/modificar-registro",component:Ke,meta:{requiresAuth:!0}},{path:"/editar/:id_ingreso",name:"EditarIngreso",component:Ce,props:!0,meta:{requiresAuth:!0}}],We=(0,E.aE)({history:(0,E.Bt)(),routes:Ze});We.beforeEach(((e,o,r)=>{const a=localStorage.getItem("session_token"),s=e.matched.some((e=>e.meta.requiresAuth));s&&!a?(sessionStorage.setItem("redirect_message","Debe iniciar sesión para acceder a esta página."),r("/")):(e.path,r())}));var Ye=We;r(454);_.A.defaults.baseURL="http://localhost:3002/api/",C.setupAxiosInterceptors();const eo=(0,a.Ef)(k);eo.use(Ye),eo.mount("#app")}},o={};function r(a){var s=o[a];if(void 0!==s)return s.exports;var i=o[a]={exports:{}};return e[a].call(i.exports,i,i.exports,r),i.exports}r.m=e,function(){var e=[];r.O=function(o,a,s,i){if(!a){var t=1/0;for(u=0;u<e.length;u++){a=e[u][0],s=e[u][1],i=e[u][2];for(var n=!0,c=0;c<a.length;c++)(!1&i||t>=i)&&Object.keys(r.O).every((function(e){return r.O[e](a[c])}))?a.splice(c--,1):(n=!1,i<t&&(t=i));if(n){e.splice(u--,1);var l=s();void 0!==l&&(o=l)}}return o}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[a,s,i]}}(),function(){r.d=function(e,o){for(var a in o)r.o(o,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:o[a]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)}}(),function(){r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};r.O.j=function(o){return 0===e[o]};var o=function(o,a){var s,i,t=a[0],n=a[1],c=a[2],l=0;if(t.some((function(o){return 0!==e[o]}))){for(s in n)r.o(n,s)&&(r.m[s]=n[s]);if(c)var u=c(r)}for(o&&o(a);l<t.length;l++)i=t[l],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return r.O(u)},a=self["webpackChunkforense"]=self["webpackChunkforense"]||[];a.forEach(o.bind(null,0)),a.push=o.bind(null,a.push.bind(a))}();var a=r.O(void 0,[504],(function(){return r(3153)}));a=r.O(a)})();
//# sourceMappingURL=app.df904b60.js.map